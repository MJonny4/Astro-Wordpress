---
import BlockRenderer from '../components/BlockRenderer.astro';
import CommonHead from '../components/CommonHead.astro';

const response = await fetch(`${import.meta.env.WPGRAPHQL_URL}`, {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify({
        query: `query PageQuery {
            nodeByUri(uri: "/") {
                ... on Page {
                    id
                    blocks
                    seo {
                        metaDesc
                        title
                    }
                }
            }
        }`,
    }),
});

const { data } = await response.json();
---

<html lang="en">
    <CommonHead title={data.nodeByUri?.seo?.title} description={data.nodeByUri?.seo?.metaDesc} />
    <body>
        <BlockRenderer blocks={data.nodeByUri?.blocks || []} />
    </body>
</html>
